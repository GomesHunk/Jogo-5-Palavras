<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Jogo das 5 Palavras - Revisto</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:400,500,600,700&display=swap">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.0/socket.io.min.js"></script>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0;}
    body {
      font-family: 'Inter', sans-serif;
      background: linear-gradient(135deg, #6a82fb, #fc5c7d); /* Gradiente mais vibrante */
      color: #333; min-height: 100vh;
      display: flex; flex-direction: column; align-items: center;
      padding: 10px; font-size: 16px; /* Base font size for responsiveness */
    }
    .container { max-width: 1200px; width: 100%; }
    .section {
      background: rgba(255, 255, 255, 0.95); /* Leve transpar√™ncia */
      backdrop-filter: blur(5px); /* Efeito de vidro fosco se o fundo permitir */
      border-radius: 12px; /* Bordas mais arredondadas */
      padding: 20px; margin-bottom: 20px;
      box-shadow: 0 6px 20px rgba(0,0,0,0.1);
    }
    .hidden { display: none !important; }
    h1, h2, h3 { color: #4a5568; text-align: center; font-weight: 600; }
    h1 { margin-bottom: 25px; font-size: 2.2em; color: white; text-shadow: 1px 1px 3px rgba(0,0,0,0.25); }
    h2 { margin-bottom: 20px; font-size: 1.6em; }
    h3 { margin-bottom: 15px; font-size: 1.25em; color: #5a67d8; }

    /* Layout e Componentes */
    .game-layout {
      display: grid; grid-template-columns: 1fr; /* Default para mobile */
      gap: 20px; align-items: start;
    }
    @media (min-width: 769px) { /* Desktop layout */
        .game-layout { grid-template-columns: 1fr 320px; }
    }

    .game-main { min-height: 350px; }
    .game-sidebar { display: flex; flex-direction: column; gap: 15px; }
    .sidebar-section { padding: 15px; }
    .sidebar-section h3 { margin: 0 0 10px 0; font-size: 1.1em; border-bottom: 1px solid #e2e8f0; padding-bottom: 8px; }

    .player-item {
      display: flex; align-items: center; justify-content: space-between;
      padding: 10px 12px; margin: 6px 0; background: #f7fafc;
      border-radius: 8px; font-size: 0.95em; border-left: 4px solid transparent;
      transition: background-color 0.2s;
    }
    .player-name { font-weight: 500; }
    .player-status { display: flex; gap: 8px; align-items: center; font-size: 0.9em;}
    .status-icon { font-size: 1.1em; } 
    .player-item.current-turn { border-left-color: #48bb78; background-color: #f0fff4; }

    .chat-messages {
      height: 180px; overflow-y: auto; border: 1px solid #e2e8f0;
      border-radius: 8px; padding: 12px; background: #fdfdff; /* Um pouco mais claro */
      font-size: 0.9em; margin-bottom: 12px;
    }
    .chat-message { margin-bottom: 10px; line-height: 1.5; }
    .chat-timestamp { color: #a0aec0; font-size: 0.8em; margin-right: 6px; }
    .chat-player { font-weight: 600; color: #7f5af0; } /* Cor de destaque no chat */

    .chat-input-container { display: flex; gap: 8px; align-items: stretch; /* Alinha altura */ }
    .chat-input {
      flex-grow: 1; /* Ocupa espa√ßo dispon√≠vel */
      padding: 10px 14px; border: 1px solid #cbd5e0;
      border-radius: 8px; font-size: 1em; direction: ltr; 
      min-width: 0; /* Permite encolher */
    }
    .chat-send {
      padding: 10px 15px; background: #7f5af0; color: white;
      border: none; border-radius: 8px; cursor: pointer;
      font-size: 1em; font-weight: 500; transition: background 0.2s; white-space: nowrap;
      flex-shrink: 0; /* N√£o encolhe */
    }
    .chat-send:hover { background: #6c47d8; }

    label { display: block; width: 100%; margin-bottom: 6px; font-weight: 600; font-size: 0.95em; color: #4a5568; }
    input[type="text"] {
      width: 100%; padding: 12px 15px; border: 1px solid #cbd5e0;
      border-radius: 8px; margin-bottom: 18px; font-size: 1em; color: #2d3748;
    }
    input[type="text"]:focus { border-color: #7f5af0; box-shadow: 0 0 0 3px rgba(127, 90, 240, 0.2); outline: none;}

    button {
      background: #7f5af0; color: white; font-weight: 600; /* Aumenta peso da fonte */
      border: none; padding: 12px 20px; border-radius: 8px;
      cursor: pointer; transition: background 0.2s, transform 0.1s;
      width: 100%; margin-bottom: 12px; font-size: 1em; text-transform: uppercase; letter-spacing: 0.5px;
    }
    button:hover { background: #6c47d8; transform: translateY(-2px); box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
    button:active { transform: translateY(-1px); box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
    button.secondary { background: #a0aec0; }
    button.secondary:hover { background: #718096; }
    button.success { background: #48bb78; }
    button.success:hover { background: #38a169; }
    button.warning { background: #ecc94b; color: #2d3748; }
    button.warning:hover { background: #d69e2e; }

    .options-grid { display: grid; grid-template-columns: 1fr; gap: 12px; margin-bottom: 20px; }
     @media (min-width: 480px) { .options-grid { grid-template-columns: 1fr 1fr; } }

    .room-code-display {
      background: rgba(230, 237, 255, 0.8); border: 2px dashed #7f5af0; padding: 25px;
      text-align: center; border-radius: 10px; margin: 25px 0;
    }
    .room-code-value {
      font-size: 2em; font-weight: 700; color: #6c47d8; letter-spacing: 3px;
      background: white; padding: 12px 22px; border-radius: 8px; display: inline-block;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1); margin: 8px 0 15px 0;
    }
    .copy-code-btn { background: #38b2ac; margin: 0 auto; max-width: 200px; font-size: 0.9em; padding: 10px;}
    .copy-code-btn:hover { background: #2c7a7b; }

    /* Game Area */
    .game-info { text-align: center; margin-bottom: 20px; }
    .turn-info { font-size: 1.4em; font-weight: 600; color: #6c47d8; margin-bottom: 18px; }
    
    .word-progress-container { /* Novo container para a sequ√™ncia de palavras */
        display: flex;
        flex-wrap: wrap; /* Quebra para nova linha se necess√°rio em telas pequenas */
        justify-content: center;
        gap: 8px;
        margin-bottom: 20px;
        padding: 10px;
        background-color: rgba(255,255,255,0.7);
        border-radius: 8px;
    }
    .word-slot {
        background-color: #e2e8f0;
        color: #4a5568;
        padding: 10px 15px;
        border-radius: 6px;
        font-size: 1.1em;
        font-weight: 500;
        min-width: 50px; /* Para iniciais n√£o ficarem muito pequenas */
        text-align: center;
        border: 2px solid transparent;
    }
    .word-slot.completed {
        background-color: #c6f6d5; /* Verde para completas */
        color: #2f855a;
        border-color: #68d391;
    }
    .word-slot.first-word { /* Destaque para a primeira palavra dada */
        background-color: #bee3f8;
        color: #2c5282;
        border-color: #63b3ed;
        font-weight: 600;
    }
     .word-slot.active-to-guess { /* Opcional: se quiser destacar o slot da dica atual */
        border-color: #7f5af0;
        box-shadow: 0 0 0 2px rgba(127, 90, 240, 0.3);
    }


    .hint-display { /* Para a dica atual "M _ _" */
      font-size: 2em; font-family: monospace; background: white;
      padding: 18px; border-radius: 10px; border: 2px solid #e2e8f0;
      letter-spacing: 4px; margin: 15px 0 25px 0; color: #2d3748;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    }
    .guess-container { display: flex; gap: 10px; margin-top: 15px; align-items: stretch; }
    .guess-input {
        flex-grow: 1; /* Ocupa espa√ßo */
        margin-bottom: 0;
        min-width: 0; /* Permite encolher */
    }
    .guess-button {
        margin-bottom: 0;
        min-width: 120px; /* Tamanho m√≠nimo para desktop */
        flex-shrink: 0; /* N√£o encolhe */
    }

    .word-inputs-container input[type="text"] { margin-bottom: 12px; }

    .waiting-screen { text-align: center; padding: 35px 20px; }
    .waiting-animation { font-size: 2.8em; margin: 18px 0; animation: pulse 1.8s infinite ease-in-out; }
    @keyframes pulse { 0%, 100% { opacity: 0.7; transform: scale(0.98);} 50% { opacity: 1; transform: scale(1.02);}}

    #game-finished-message { font-weight: 600; margin-bottom: 18px; font-size: 1.1em; line-height: 1.6; }
    #new-game-button-container { margin-top: 25px;}

    .toast-notification { /* Estilo de Toast igual ao anterior */ }

    /* Responsividade Espec√≠fica para Layout de Inputs */
    @media (max-width: 768px) { /* J√° tem algumas regras, adicionando/ajustando */
      body { padding: 8px; }
      h1 { font-size: 2em; }
      .game-sidebar { order: 1; /* Chat e Jogadores abaixo do jogo principal no mobile */ }
      .chat-messages { height: 160px; }
      
      /* Ajustes para Chat e Palpite no Mobile */
      .chat-input { padding: 12px 14px; font-size: 1em; }
      .chat-send { padding: 12px 10px; font-size: 0.9em; }
      
      .guess-input { padding: 12px 14px; font-size: 1em; }
      .guess-button { min-width: auto; padding: 12px 10px; font-size: 0.9em; }
    }
    @media (max-width: 480px) {
      .section { padding: 18px 15px; } /* Aumenta padding lateral */
      h1 { font-size: 1.7em; }
      .room-code-value { font-size: 1.5em; letter-spacing: 2px; }
      .hint-display {font-size: 1.6em; padding: 15px; }
      .word-slot { font-size: 1em; padding: 8px 10px; }

      .chat-input-container, .guess-container {
          flex-direction: column; /* Empilha input e bot√£o */
          gap: 8px;
      }
      .chat-input, .guess-input { width: 100%; margin-bottom: 0; }
      .chat-send, .guess-button { width: 100%; }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üéØ Jogo das 5 Palavras</h1>

    <div class="section" id="initial-section">
      <h2>Como deseja jogar?</h2>
      <div class="options-grid">
        <button class="success" onclick="showScreen('create-room-section')">üè† Criar Nova Sala</button>
        <button class="warning" onclick="showScreen('join-room-section')">üîë Entrar em Sala</button>
      </div>
    </div>

    <div class="section hidden" id="create-room-section">
      <button class="secondary" onclick="handleGoBackToInitial()">‚Üê Voltar</button>
      <h2>Criar Nova Sala</h2>
      <label for="create-player-name">Seu Nome:</label>
      <input type="text" id="create-player-name" placeholder="Seu nome aqui..." maxlength="20" />
      <button onclick="createRoom()">Criar Sala</button>
      <div id="room-created-info" class="hidden">
        <div class="room-code-display">
          <h3>üéâ Sala Criada!</h3>
          <p>Compartilhe este c√≥digo com seu amigo:</p>
          <div class="room-code-value" id="generated-room-code">CODE</div>
          <button class="copy-code-btn" onclick="copyRoomCode()">üìã Copiar C√≥digo</button>
        </div>
        <div class="waiting-screen">
          <div class="waiting-animation">‚è≥</div>
          <p><strong>Aguardando outro jogador...</strong></p>
        </div>
      </div>
    </div>

    <div class="section hidden" id="join-room-section">
      <button class="secondary" onclick="handleGoBackToInitial()">‚Üê Voltar</button>
      <h2>Entrar em Sala</h2>
      <label for="join-player-name">Seu Nome:</label>
      <input type="text" id="join-player-name" placeholder="Seu nome aqui..." maxlength="20" />
      <label for="join-room-code">C√≥digo da Sala:</label>
      <input type="text" id="join-room-code" placeholder="C√≥digo de 6 d√≠gitos" maxlength="6" style="text-transform: uppercase;" />
      <button onclick="joinExistingRoom()">Entrar na Sala</button>
    </div>

    <div class="section hidden" id="word-selection-section">
      <button class="secondary" onclick="handleLeaveGameDuringSetup()">Sair / Voltar ao Menu</button>
      <h2>Escolha suas 5 palavras</h2>
      <p>As palavras devem ter conex√£o sem√¢ntica em sequ√™ncia. M√°x. 25 caracteres, m√≠n. 2.</p>
      <div id="word-inputs-container" class="word-inputs-container"></div>
      <button id="submit-words-button" onclick="submitWords()">Enviar Palavras</button>
      <div id="waiting-for-opponent-words" class="waiting-screen hidden">
        <div class="waiting-animation">üí¨</div>
        <p><strong>Palavras enviadas! Aguardando oponente...</strong></p>
      </div>
    </div>

    <div class="game-layout hidden" id="game-screen-layout">
      <div class="game-main">
        <div class="section" id="game-active-section">
           <button class="secondary" id="leave-active-game-button" onclick="handleLeaveActiveGame()" style="width: auto; float: right; margin-bottom: 10px; font-size: 0.8em; padding: 8px 12px;">Sair</button>
          <div class="game-info">
            <div class="turn-info" id="turn-info-display">Vez de: NomeJogador</div>
            <div id="word-progress-container" class="word-progress-container">
                </div>
            <div class="hint-display" id="current-hint-display">X _ _ _ _</div>
          </div>
          <div class="guess-container">
            <input type="text" id="guess-input" class="guess-input" placeholder="Seu palpite..." />
            <button onclick="sendGuess()" class="guess-button success">Enviar Palpite</button>
          </div>
          <div id="game-finished-display" class="hidden" style="margin-top: 20px; text-align: center;">
            <h3 id="game-finished-message">Jogo Finalizado!</h3>
            <div id="new-game-button-container">
              <button class="warning" onclick="requestNewGame()">‚ú® Jogar Novamente</button>
              <button class="secondary" onclick="handleGoBackToInitial()">Voltar ao Menu</button>
            </div>
          </div>
        </div>
      </div>
      <div class="game-sidebar">
        <div class="sidebar-section">
          <h3>üë• Jogadores</h3>
          <div id="players-list"></div>
        </div>
        <div class="sidebar-section">
          <h3>üí¨ Chat</h3>
          <div class="chat-messages" id="chat-messages-box"></div>
          <div class="chat-input-container">
            <input type="text" id="chat-message-input" class="chat-input" placeholder="Mensagem..." maxlength="100" />
            <button onclick="sendChatMessage()" class="chat-send">Enviar</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    const socket = io(); 
    let currentPlayerName = '';
    let currentRoomId = '';
    let myWordsToGuessStore = []; // Armazena as palavras que EU preciso adivinhar
    let myCompletedMaskStore = []; // Armazena minha m√°scara de palavras completas
    const NUM_WORDS_EXPECTED = 5; 

    const screens = [
      "initial-section", "create-room-section", "join-room-section",
      "word-selection-section", "game-screen-layout"
    ];
    function showScreen(screenIdToShow) {
      screens.forEach(id => document.getElementById(id).classList.add("hidden"));
      const screenEl = document.getElementById(screenIdToShow);
      if(screenEl) screenEl.classList.remove("hidden");
      
      if (screenIdToShow === 'create-room-section') { 
        document.getElementById('room-created-info').classList.add('hidden');
        document.getElementById('create-player-name').value = '';
      } else if (screenIdToShow === 'join-room-section') {
        document.getElementById('join-player-name').value = '';
        document.getElementById('join-room-code').value = '';
      }
      document.getElementById('game-finished-display').classList.add('hidden'); // Esconde msg de fim de jogo ao mudar de tela
    }

    function showToast(message, type = 'info') { /* ... (fun√ß√£o toast igual √† anterior) ... */ }

    function copyRoomCode() { /* ... (fun√ß√£o igual √† anterior) ... */ }
    
    function handleGoBackToInitial() {
        // Se estiver em uma sala, pode precisar notificar o servidor
        if (currentRoomId) {
            // Poderia adicionar uma confirma√ß√£o se o jogo estiver ativo
            // console.log("Voltando ao menu, currentRoomId:", currentRoomId);
            // socket.emit("player_initiated_leave"); // Se quiser notificar sa√≠da da sala
        }
        showScreen('initial-section');
        currentRoomId = ''; // Limpa o ID da sala ao voltar pro menu
        // Outros resets de estado de jogo local podem ser necess√°rios
    }
    
    function handleLeaveGameDuringSetup(){
        if(currentRoomId){ // Se j√° criou/entrou numa sala mas ainda n√£o come√ßou o jogo
            socket.emit("player_initiated_leave");
        }
        showScreen('initial-section');
        currentRoomId = '';
    }
    function handleLeaveActiveGame(){
        if (currentRoomId && confirm("Tem certeza que deseja sair da partida?")) {
            socket.emit("player_initiated_leave");
            showScreen('initial-section');
            currentRoomId = '';
        }
    }


    function createRoom() { /* ... (fun√ß√£o igual √† anterior, usando showToast) ... */ }
    function joinExistingRoom() { /* ... (fun√ß√£o igual √† anterior, usando showToast) ... */ }
    function createWordInputFields() { /* ... (fun√ß√£o igual √† anterior) ... */ }
    function submitWords() { /* ... (fun√ß√£o igual √† anterior, usando showToast) ... */ }
    function sendGuess() { /* ... (fun√ß√£o igual √† anterior, usando showToast) ... */ }
    function sendChatMessage() { /* ... (fun√ß√£o igual √† anterior) ... */ }
    function addMessageToChat(playerName, message, timestamp) { /* ... (fun√ß√£o igual √† anterior) ... */ }
    function requestNewGame() { 
        socket.emit("request_new_game", {});
        document.getElementById('game-finished-display').classList.add('hidden'); 
    }


    function updateTurnDisplay(isMyTurn, turnPlayerName) {
        const turnInfoEl = document.getElementById("turn-info-display");
        const guessInputEl = document.getElementById("guess-input");
        const guessButtonEl = document.querySelector(".guess-button");

        if (!turnInfoEl || !guessInputEl || !guessButtonEl) return; // Elementos n√£o existem ainda

        if (isMyTurn) {
            turnInfoEl.textContent = "üéØ √â a sua vez!";
            turnInfoEl.style.color = "#48bb78";
            guessInputEl.disabled = false;
            guessButtonEl.disabled = false;
            setTimeout(() => guessInputEl.focus(), 100); // Foco com pequeno delay
        } else {
            turnInfoEl.textContent = `Aguardando ${turnPlayerName || 'oponente'}...`;
            turnInfoEl.style.color = "#a0aec0"; // Cor mais neutra para aguardo
            guessInputEl.disabled = true;
            guessButtonEl.disabled = true;
        }
    }
    
    function renderWordProgressDisplay(originalWords, completedMask, activeWordIdx) {
        const container = document.getElementById("word-progress-container");
        if (!container) return;
        container.innerHTML = ""; // Limpa o container

        originalWords.forEach((word, index) => {
            const slot = document.createElement("div");
            slot.classList.add("word-slot");

            if (index === 0) { // Primeira palavra sempre completa e destacada
                slot.textContent = word.toUpperCase();
                slot.classList.add("first-word");
                if(completedMask[index]) slot.classList.add("completed"); // Pode j√° estar completa
            } else if (completedMask[index]) {
                slot.textContent = word.toUpperCase();
                slot.classList.add("completed");
            } else {
                slot.textContent = word[0].toUpperCase(); // Mostra s√≥ a inicial
            }
            
            // Opcional: destacar o slot da palavra que est√° sendo adivinhada ATIVAMENTE
            // (aquela para a qual a #current-hint-display se refere)
            // if (index === activeWordIdx && !completedMask[index]) {
            //    slot.classList.add("active-to-guess");
            // }
            container.appendChild(slot);
        });
    }

    // --- Handlers de Eventos Socket.IO ---
    socket.on("connected", () => showToast("Conectado ao servidor!", "success"));
    socket.on("error", (data) => showToast(data.message || "Erro desconhecido.", "error"));

    socket.on("joined_room", (data) => {
      currentRoomId = data.room_id;
      // currentPlayerName j√° foi definido ao criar/entrar na sala
      showToast(`Entrou na sala: ${data.room_id}`, "success");
      if (data.is_creator) {
        document.getElementById("generated-room-code").textContent = data.room_id;
        document.getElementById("room-created-info").classList.remove("hidden");
      }
    });

    socket.on("players_update", (data) => { /* ... (l√≥gica igual ou similar √† anterior, usando currentPlayerName) ... */ });
    
    socket.on("start_choosing_words", (data) => {
        showScreen('word-selection-section');
        createWordInputFields();
        document.getElementById("waiting-for-opponent-words").classList.add("hidden");
        document.getElementById("submit-words-button").disabled = false;
        if(data.message) showToast(data.message, "info");
    });

    socket.on("words_submitted_update", (data) => { /* ... (l√≥gica igual ou similar √† anterior) ... */ });

    socket.on("game_started", (data) => {
      showScreen('game-screen-layout');
      myWordsToGuessStore = data.your_words_to_guess_original || [];
      myCompletedMaskStore = data.your_completed_mask || Array(NUM_WORDS_EXPECTED).fill(false);

      renderWordProgressDisplay(myWordsToGuessStore, myCompletedMaskStore, data.active_word_idx);
      document.getElementById("current-hint-display").textContent = data.current_hint_for_active_word || "ERRO_NA_DICA";
      updateTurnDisplay(data.is_your_turn, data.current_turn_player_name);
      showToast("O jogo come√ßou! Boa sorte!", "success");
    });

    socket.on("correct_guess_update", (data) => {
        // Atualiza se o palpite foi do jogador atual
        if (data.guessing_player_name === currentPlayerName) {
            myCompletedMaskStore = data.guesser_completed_mask;
            myWordsToGuessStore = data.guesser_words_original; // Caso precise recarregar
            renderWordProgressDisplay(myWordsToGuessStore, myCompletedMaskStore, data.active_word_idx);
            document.getElementById("current-hint-display").textContent = data.next_hint_for_active_word;
        }
        showToast(`${data.guessing_player_name} acertou "${data.guessed_word_original}"!`, "success");
        updateTurnDisplay(data.current_turn_player_name === currentPlayerName, data.current_turn_player_name);
    });
    
    // O jogador que errou recebe este evento para atualizar sua pr√≥pria dica
    socket.on("incorrect_guess_feedback_to_guesser", (data) => {
        document.getElementById("current-hint-display").textContent = data.your_updated_hint;
        // N√£o precisa atualizar o word-progress-display aqui, pois nenhuma palavra foi completada
    });

    // Ambos os jogadores recebem este para atualizar o turno
    socket.on("turn_change_after_incorrect_guess", (data) => {
        showToast(`${data.player_who_erred_name} errou com "${data.their_incorrect_guess}".`, "info");
        updateTurnDisplay(data.current_turn_player_name === currentPlayerName, data.current_turn_player_name);
        // Se for a vez do jogador atual AGORA, e ele recebeu nova dica por este evento:
        if (data.current_turn_player_name === currentPlayerName && data.next_player_hint_data) {
             if (myWordsToGuessStore && myWordsToGuessStore.length > 0) { // Garante que as palavras j√° foram carregadas
                renderWordProgressDisplay(myWordsToGuessStore, myCompletedMaskStore, data.next_player_hint_data.active_word_idx);
            }
            document.getElementById("current-hint-display").textContent = data.next_player_hint_data.hint;
        }
    });
    
    socket.on("game_finished", (data) => {
        showToast(data.message, data.winner_name === currentPlayerName ? "success" : "info");
        document.getElementById("game-finished-message").textContent = data.message;
        if (data.was_disconnection === false && data.guesser_words_original) { // Se terminou normalmente, mostra a sequ√™ncia do vencedor
            document.getElementById("game-finished-message").textContent += ` Sequ√™ncia correta: ${data.guesser_words_original.join(' ‚Üí ')}`;
        }
        document.getElementById("game-finished-display").classList.remove("hidden");
        document.getElementById("guess-input").disabled = true;
        document.querySelector(".guess-button").disabled = true;
        // Limpa o hint display e o word progress
        document.getElementById("current-hint-display").textContent = "FIM DE JOGO";
        document.getElementById("word-progress-container").innerHTML = "";
    });
    
    socket.on("opponent_left_game", (data) => { // Oponente saiu via bot√£o "Sair"
        showToast(data.message, "warning");
        // A l√≥gica de game_finished j√° deve ter sido acionada pelo backend para o jogador restante
    });


    socket.on("game_reset_initiated", (data) => { /* ... (igual √† anterior, preparando para start_choosing_words) ... */ });
    socket.on("new_chat_message", (data) => { /* ... (igual √† anterior) ... */ });

    // Listeners de Teclado e Inputs (semelhantes aos anteriores)
    // ...

    // Iniciar na tela inicial
    showScreen("initial-section");

    // Fun√ß√µes showToast, copyRoomCode, createRoom, joinExistingRoom, etc.
    // (Copiar do script anterior, fazendo ajustes para usar showToast para erros)
    // Exemplo de ajuste em createRoom:
    function createRoom() {
      currentPlayerName = document.getElementById("create-player-name").value.trim();
      if (!currentPlayerName || currentPlayerName.length < 2) {
        showToast("Nome inv√°lido (m√≠n. 2 caracteres).", "error"); return;
      }
      socket.emit("join_game", { player_name: currentPlayerName });
    }
    // Fazer o mesmo para joinExistingRoom, submitWords, sendGuess

  </script>
</body>
</html>
